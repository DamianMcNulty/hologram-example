function PhotoPlayer(e){e=e||{};var t=function(){};this.step=e.step||1;this.enctype=e.enctype||null;this.data=e.photos||[];this.template=e.template||"";this.container=e.container||"";this.stripClass=e.stripClass||"b-photoplayer_strip";this.currentClass=e.currentClass||"current";this.photoElement=e.photoElement||".b-photoplayer_photo";this.photoImageElement=e.photoImageElement||".b-photoplayer_photo>img";this.current=e.current||1;this.cacheSizes=typeof e.cacheSizes=="undefined"?true:e.cacheSizes;this.listeners={create:e.onCreate||t,change:e.onChange||t,update:e.onUpdate||t};this.scroller=e.scroller||function(e,t,n,r){e.css("text-indent","-"+t*n*r+"px");if(window.x&&window.x.isMSIE&&window.x.version<8){e.scrollLeft(t*n*r)}};this.init();this.build()}function Templater(e){e=e||{};this.data=e.data;this.container=e.container;this.template=e.template;this.onUpdate=e.onUpdate||{};this.onCreate=e.onCreate||{};this.attributes=e.attributes||["alt","id","name","src","value"];this.custom=e.custom||{data:function(e,t){return this.data(t,e)},html:jQuery.fn.html,lazy:this._curry(jQuery.fn.attr,"data-lazy")};this._partials={};this._stack=[];this.init()}function Modal(e){var t=this,n=function(){};e=e||{};t.element=e.element;t.fixed=e.fixed||false;t.strict=e.strict||false;t.cover=e.cover||"neutral";t.active=false;t.coverElement=$('<div class="modalCover modalCover_'+t.cover+'"></div>');$(document).keydown(function(e){if(!t.active||t.strict)return;if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey){return}if($("input:focus, textarea:focus, select:focus").length){return}if(e.which==27){e.preventDefault();t.deactivate()}});this.listeners={activate:e.onActivate||n,deactivate:e.onDeactivate||n}}$(document).ready(function(){$(".boxClose").click(function(){$(this).closest(".box").fadeOut("slow")})});PhotoPlayer.prototype.init=function(){this.photos=[];for(var t=0;t<this.data.photo_urls.length;t++){this.photos.push({index:t+1,url:this.data.photo_urls[t].thumbnail_url?this.enctype?this.enctype(this.data.photo_urls[t].thumbnail_url):this.data.photo_urls[t].thumbnail_url:"",zoom:this.data.photo_urls[t].large_photo_url?this.enctype?this.enctype(this.data.photo_urls[t].large_photo_url):this.data.photo_urls[t].large_photo_url:"",caption:this.data.captions[t]?this.enctype?this.enctype(this.data.captions[t]):this.data.captions[t]:""})}if(this.current){this.currentPhoto=this.photos[this.current-1]}};PhotoPlayer.prototype.build=function(){var t=this;var n={photos:t.photos,currentPhoto:t.currentPhoto,currentIndex:t.current,prev:function(){t.prev()},next:function(e){t.next()},changePhoto:function(e){t.photo($(e.currentTarget).data("index"))}};t._t=new Templater({data:n,container:t.container,template:t.template,onUpdate:{currentIndex:t._bind(t._updateCurrentIndex,t),currentPhoto:t._bind(t._updateCurrentPhoto,t)},onCreate:{currentIndex:t._bind(t._updateCurrentIndex,t),currentPhoto:t._bind(t._updateCurrentPhoto,t)}});$(t._t).on("dumped",function(){t.listeners.create.call(this,t.currentPhoto,t.current);t.listeners.update.call(this,t.currentPhoto,t.current)});t._t.dump()};PhotoPlayer.prototype.prev=function(){var t=this.current-this.step;if(t<1){t=this.photos.length}this.photo(t)};PhotoPlayer.prototype.next=function(){var t=this.current+this.step;if(t>this.photos.length){t=1}this.photo(t)};PhotoPlayer.prototype.photo=function(t){if(!t)return;this.current=t;this.currentPhoto=this.photos[this.current-1];this._t.partial({currentPhoto:this.currentPhoto,currentIndex:this.current});this.listeners.change.call(this,this.currentPhoto,this.current);this.listeners.update.call(this,this.currentPhoto,this.current);$(this).trigger("photo:change",{index:this.current,photo:this.currentPhoto})};PhotoPlayer.prototype._updateCurrentIndex=function(t,n){function s(e,t){var n;e=e[0];n=" "+e.className+" ";if(n.indexOf(" "+t+" ")==-1){e.className=$.trim(n+t)}}function o(e,t){var n;e=e[0];n=" "+e.className+" ";if(n.indexOf(" "+t+" ")!=-1){e.className=$.trim(n.replace(" "+t+" "," "))}}var r,i;if(t.hasClass(this.stripClass)){if(!this.cacheSizes||!this._unitWidth){this._unitWidth=t.find(this.photoElement).outerWidth(true);this._stripLength=t.width();this._unitsPerFrame=Math.round(this._stripLength/this._unitWidth)}r=Math.floor((n-1)/this._unitsPerFrame);this.scroller(t,r,this._unitWidth,this._unitsPerFrame);i=r*this._unitsPerFrame;$(this.photoImageElement,t).slice(Math.max(i-1,0),i+this._unitsPerFrame+1).each(function(e,t){var n;t=$(t);if(n=t.data("lazy")){t.attr("src",n);t.removeAttr("data-lazy");t.data("lazy",null)}})}else{if(t.data("index")==n){s(t,this.currentClass)}else{o(t,this.currentClass)}}};PhotoPlayer.prototype._updateCurrentPhoto=function(t,n){function i(){var e;if(this.width>this.height){e="landscape"}else{e="portrait"}r._orientationCache[n.zoom]=e;s(t,e)}function s(e,t){if(t=="landscape"){e.removeClass("portrait").addClass(t)}else{e.removeClass("landscape").addClass(t)}}var r=this;if(!r._orientationCache)r._orientationCache={};if(!r._orientationCache[n.zoom]){if(t.attr("src")==n.zoom){i.call(t)}else{t.removeClass("landscape");t.removeClass("portrait");t.one("load",i)}}else{s(t,r._orientationCache[n.zoom])}};PhotoPlayer.prototype._bind=function(t,n){if(Function.prototype.bind)return Function.prototype.bind.apply(t,Array.prototype.slice.call(arguments,1));var r=Array.prototype.slice.call(arguments,2);return function(){t.apply(n,r.concat(Array.prototype.slice.call(arguments)))}};Templater.prototype.init=function(){if(typeof this.container=="string"){this.container=document.getElementById(this.container)}if(typeof this.template=="string"){this.template=document.getElementById(this.template)}this.workspace=$(this.template).clone().removeAttr("id")};Templater.prototype.dump=function(){this._process(this.workspace,this.data);$(this.container).html(this.workspace);$(this).trigger("dumped");return this.workspace};Templater.prototype.partial=function(t,n){var r,i,s,o=this;n=n||this._partials;for(r in t){if(t.hasOwnProperty(r)&&n.hasOwnProperty(r)){if(typeof t[r]=="object"){o.partial(t[r],n[r])}for(s in n[r]){if(!n[r].hasOwnProperty(s))continue;i=s.substr(1);if(s=="_update"){if(typeof o.onUpdate[r]=="function"){$.each(n[r][s],function(e,n){o.onUpdate[r](n,t[r])})}}else if(i in o.custom&&typeof o.custom[i]=="function"){$.each(n[r][s],function(e,n){o.custom[i].call(n,t[r],r)})}else if($.inArray(i,o.attributes)!=-1){$.each(n[r][s],function(e,n){n.attr(i,t[r])})}else{o.partial(t[r],n[r])}}}}};Templater.prototype._process=function(t,n,r,i){if(typeof r!="undefined")this._stack.push(r);if(typeof i!="undefined")this._stack.push(i);this._list(t,n,r);this._with(t,n,r);this._custom(t,n,r);this._attributes(t,n,r);this._click(t,n,r);this._update(t,n,r);if(typeof i!="undefined")this._stack.pop();if(typeof r!="undefined")this._stack.pop();return t};Templater.prototype._attributes=function(t,n,r){var i=this;$.each(i.attributes,function(e,r){$(t).find("[data-t-"+r+"]").andSelf().each(function(e,t){t=$(t);var s=t.data("t-"+r);t.removeAttr("data-t-"+r);t.data("t-"+r,null);if(s&&n.hasOwnProperty(s)){t.attr(r,n[s]);i._partialsFor("_"+r)(t,s,i._stack)}else if(s&&i.data.hasOwnProperty(s)){t.attr(r,i.data[s]);i._partialsFor("_"+r)(t,s,[])}})});return t};Templater.prototype._custom=function(t,n,r){var i=this;$.each(i.custom,function(e,r){if(typeof r!="function")return;$(t).find("[data-t-"+e+"]").andSelf().each(function(t,s){s=$(s);var o=s.data("t-"+e);s.removeAttr("data-t-"+e);s.data("t-"+e,null);if(o&&n.hasOwnProperty(o)){r.call(s,n[o],o);i._partialsFor("_"+e)(s,o,i._stack)}else if(o&&i.data.hasOwnProperty(o)){r.call(s,i.data[o],o);i._partialsFor("_"+e)(s,o,[])}})});return t};Templater.prototype._update=function(t,n,r){var i=this;$(t).find("[data-t-update]").andSelf().each(function(e,t){t=$(t);var r=t.data("t-update");t.removeAttr("data-t-update");t.data("t-update",null);if(r&&n.hasOwnProperty(r)){if(typeof i.onCreate[r]=="function"){$(i).on("dumped",function(){i.onCreate[r](t,n[r])})}i._partialsFor("_update")(t,r,i._stack)}else if(r&&i.data.hasOwnProperty(r)){if(typeof i.onCreate[r]=="function"){$(i).on("dumped",function(){i.onCreate[r](t,i.data[r])})}i._partialsFor("_update")(t,r,[])}});return t};Templater.prototype._click=function(t,n,r){var i=this;$(t).find("[data-t-click]").andSelf().each(function(e,t){t=$(t);var r=t.data("t-click");t.removeAttr("data-t-click");t.data("t-click",null);if(r&&n.hasOwnProperty(r)&&typeof n[r]=="function"){t.on("click",n[r]);i._partialsFor("_click")(t,r,i._stack)}else if(r&&i.data.hasOwnProperty(r)&&typeof i.data[r]=="function"){t.on("click",i.data[r]);i._partialsFor("_click")(t,r,[])}});return t};Templater.prototype._list=function(t,n,r){function s(e,t,n){var r=e;$.each(t,function(t,s){var o=e.clone();i._process(o,s,n,t);r.after(o);r=o})}var i=this;$(t).find("[data-t-list]").andSelf().each(function(e,t){t=$(t);var r=t.data("t-list");t.removeAttr("data-t-list");t.data("t-list",null);if(r&&n.hasOwnProperty(r)){s(t,n[r],r)}else if(r&&i.data.hasOwnProperty(r)){s(t,i.data[r],r)}if(r)t.remove()});return t};Templater.prototype._with=function(t,n,r){function s(e,t,n){i._process(e,t,n)}var i=this;$(t).find("[data-t-with]").andSelf().each(function(e,t){t=$(t);var r=t.data("t-with");t.removeAttr("data-t-with");t.data("t-with",null);if(r&&n.hasOwnProperty(r)){s(t,n[r],r)}else if(r&&i.data.hasOwnProperty(r)){s(t,i.data[r],r)}});return t};Templater.prototype._partialsFor=function(t){var n=this;return function(r,i,s){s=s||[];var o=s.concat(i),u=n._partials;for(var a=0;a<o.length;a++){if(!u[o[a]])u[o[a]]={};u=u[o[a]]}if(!u[t])u[t]=[];u[t].push(r)}};Templater.prototype._curry=function(t){var n=Array.prototype.slice.call(arguments,1);return function(){t.apply(this,n.concat(Array.prototype.slice.call(arguments)))}};$.fn.dropdown=function(){this.each(function(){var e=$(this),t=e.find(".dropdownTrigger"),n=e.find(".dropdownBox");t.attr({"aria-haspopup":"true",tabindex:0,role:"menuitem"});n.attr("aria-hidden","true");t.hover(function(){e.addClass("active");n.attr("aria-hidden","false")},function(){e.removeClass("active");n.attr("aria-hidden","true")});n.hover(function(){e.addClass("active");n.attr("aria-hidden","false")},function(){e.removeClass("active");n.attr("aria-hidden","true")})})};Modal.prototype.activate=function(){var t=this;if(this.active)return;this.coverElement.insertAfter(this.element);if(!this.strict){this.coverElement.one("click",function(){t.deactivate()})}this.element.addClass("beingModal");if(this.fixed){$("body").addClass("underModal")}this.active=true;this.listeners.activate.call(this)};Modal.prototype.deactivate=function(){this.coverElement.remove();$("body").removeClass("underModal");this.element.removeClass("beingModal");this.active=false;this.listeners.deactivate.call(this)};(function(e){function t(t){var n=e(t).find("a");n.hide();e(t).append('<span class="active">'+n.html()+"</span>")}function n(t){e(t).find(".active").remove();e(t).find("a").show()}var r={init:function(r){return this.each(function(){var i,s,o=this,u={},a=e.extend({selected:0},r);if(e(this).data("navInit")!==true){e(this).data("navInit",true);if(a.selected!==false){t(e(this).find(">li").eq(a.selected));e(this).data("selected",a.selected)}s=e(this).data("body");e(this).on("click","li a",function(r){var i=e(this).parent("li"),s=e(o).data("selected");if(typeof s!=="undefined"&&!isNaN(s)){n(e(o).find(">li").eq(s))}t(i);e(o).trigger("nav:change",[i,i.index()]);e(o).data("selected",i.index());if(e(this).attr("follow")!=="true"){r.preventDefault()}})}})},select:function(t){return this.each(function(){var r=e(this).find(">li").eq(t),i=e(this).data("selected");if(t===false){n(e(this).find(">li").eq(i))}else if(r.find(".active").length<1){r.find(">a").trigger("click")}})}};e.fn.navigationSet=function(t){if(typeof t==="string"&&typeof r[t]==="function"){return r[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return r.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.navigationSet")}}})(jQuery);$.fn.rating=function(){this.each(function(){var e=$(this),t=$("ul",e),n=$("li",t),r=$(".ratingValue",e),i=r.attr("data-rating-title"),s;t.addClass("ratingGroup");r.text(i);n.mouseover(function(){var e=$(this);e.nextAll("li").removeClass("ratingOn");e.prevAll("li").addClass("ratingOn");e.addClass("ratingOn");s=e.text();r.text(s)});t.mouseout(function(){var e=$(this);e.children("li").removeClass("ratingOn");e.find("li input:checked").parent("li").trigger("mouseover");if(!$(".ratingOn",t).length){r.text(i)}});$("input:checked",e).parent("li").trigger("mouseover")})};(function(e){var t={};var n={init:function(r){return this.each(function(){r=e.extend({offset:0},r);if(e(this).data("scrollyInit")!==true){e(this).data("scrollyInit",true);t.$el=e(this);t.position=t.$el.position();t.$container=e(window);t.offset=r.offset;t.$container.on("scroll",n.scrolly);t.$container.triggerHandler("scroll")}})},scrolly:function(e){var n=t.position.top>=t.$container.scrollTop()-t.offset;if(n&&t.$el.data("scrolly")){t.$el.data("scrolly",false);t.$el.triggerHandler("scrolly:atSetPoint",[false])}else if(!n&&!t.$el.data("scrolly")){console.log("at point");t.$el.data("scrolly",true);t.$el.triggerHandler("scrolly:atSetPoint",[true])}}};e.fn.scrolly=function(t){if(typeof t==="string"&&typeof n[t]==="function"){return n[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return n.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.scrolly")}}})(jQuery);(function(e){e.fn.sticky=function(t){t=e.extend({scrollyOffset:0,css:{},targetEl:null,toggleClass:""},t);if(e(this).data("stickyInit")!==true){e(this).data("stickyInit",true);var n=e(t.targetEl).length?e(t.targetEl):e(this);var r=n.position().top;n.on("scrolly:atSetPoint",function(n,r){var i=e(this);if(r){i.css(t.css)}else{i.removeAttr("style")}i.toggleClass("sticky").toggleClass(t.toggleClass)});e(this).scrolly({offset:t.scrollyOffset})}}})(jQuery);(function(e){var t={init:function(t){return this.each(function(){var n,r,i,s=e.extend({selected:0,body:""},t);if(e(s.body).length){r=e(s.body)}else{r=e(this).data("body")}if(r){if(s.selected!==false){i=e(r).find(">li").eq(s.selected)}e(this).navigationSet({selected:s.selected});e(r).find(">li").not(i).hide();e(this).on("nav:change.tabSet",function(t,i,s){n=e(r);n.find(">li:visible").hide();n.each(function(){e(this).find(">li").eq(s).show()})})}})},select:function(t){return e(this).navigationSet("select",t)}};e.fn.truliaTabs=function(n){if(typeof n==="string"&&typeof t[n]==="function"){return t[n].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof n==="object"||!n){return t.init.apply(this,arguments)}else{e.error("Method "+n+" does not exist on jQuery.truliaTabs")}}})(jQuery);$(document).ready(function(){$(".tagClose").click(function(){$(this).closest(".tag").addClass("hideFully");$(this).trigger("tag:close")});$(".tagAction").click(function(){$(this).trigger("tag:action")})});(function(e){var t=function(e){if(e.hasClass("toggleArrow")){e.toggleClass("toggleArrowActive")}};var n={init:function(){return this.each(function(){if(e(this).data("toggleInit")!==true){e(this).data("toggleInit",true);e(this).click(function(e){e.preventDefault();n.toggle.apply(this)})}})},toggle:function(n){return e(this).each(function(){var r,i,s,o=false;r=e(this);s=e(r.attr("href"));if(n||n===false){o=s.hasClass("hideVisually")===n;r.toggleClass("toggleActive",n);s.toggleClass("hideVisually",!n)}else{o=true;r.toggleClass("toggleActive");s.toggleClass("hideVisually")}if(o){t(r);i=r.data();if(i.toggleText){var u=i.toggleText;r.data("toggleText",r.text());r.text(u)}r.trigger("toggle",[n||r.hasClass("toggleActive")])}})}};e.fn.truliaToggle=function(t){if(typeof t==="string"&&typeof n[t]==="function"){return n[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return n.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.truliaToggle")}}})(jQuery);(function(e){var t="",n;if(typeof document.all!=="undefined"&&navigator.userAgent.match(/MSIE ([78])/)){n=RegExp.$1;t='<span class="before ie ie'+n+'"></span>'}var r=null;var i=function(){var t=e(this).data("tooltip-config");if(t.disabled){return}t.hover_state="in";if(t.delay){setTimeout(function(){if(t.hover_state=="in"){o(t)}},t.delay)}else{o(t)}};var s=function(){var t=e(this).data("tooltip-config");t.hover_state="out";if(t.delay){setTimeout(function(){if(t.hover_state=="out"){a(t)}},t.delay)}else{a(t)}};var o=function(e){if(!e.tooltip.is(":visible")){r.hide();var t,n,i;var s=e.target.offset();var o=e.offset.split("x");if(o.length>0){o[0]=parseInt(o[0],10)}if(o.length>1){o[1]=parseInt(o[1],10)}if(e.hasStem){t=7}else{t=1}switch(e.anchor){case"right":n=e.target.outerWidth(true);i=e.target.outerHeight();e.tooltip.css({position:"absolute",top:s.top-i/2-o[1],left:s.left+n+t+o[0]});break;case"left":n=e.tooltip.outerWidth(true);i=e.target.outerHeight();e.tooltip.css({position:"absolute",display:"none",visibility:"visible",top:s.top-i/2-2-o[1],left:s.left-n-t-o[0]});break;case"bottom":i=e.target.outerHeight(true);e.tooltip.css({position:"absolute",top:s.top+i+t+o[1],left:s.left-t+o[0]});break;case"top":i=e.tooltip.outerHeight(true);e.tooltip.css({position:"absolute",top:s.top-i-t-o[1],left:s.left-t+o[0],display:"none",visibility:"visible"});break;case"topright":i=e.tooltip.outerHeight(true);n=e.tooltip.outerWidth(true);targetWidth=e.target.outerWidth(true);e.tooltip.css({position:"absolute",top:s.top-i-t-o[1],left:s.left-n+targetWidth-o[0],display:"none",visibility:"visible"});break;case"bottomright":i=e.target.outerHeight(true);n=e.tooltip.outerWidth(true);targetWidth=e.target.outerWidth(true);e.tooltip.css({position:"absolute",top:s.top+i+t+o[1],left:s.left-n+targetWidth+t-o[0],display:"none",visibility:"visible"});break}e.tooltip.fadeIn();if(e.trigger==="hover"){e.tooltip.on("mouseenter",function(){e.hover_state="in"});e.tooltip.on("mouseleave",function(){a(e)})}}};var u=function(t,n,r,i){var s=e(t).data(i);if(typeof s!=="undefined"){n[r]=s}};var a=function(e){e.tooltip.fadeOut()};var f={init:function(o){o=e.extend({anchor:"right",selector:false,trigger:"hover",skin:"tooltipLight",delay:200,offset:"0x0",content:"",hasStem:true,css:{}},o);return this.each(function(){var a=e(this).data("tooltipConfig");var f;var l=e.extend({},o);u(this,l,"anchor","tooltipAnchor");u(this,l,"skin","tooltipSkin");if(!a){if(l.selector!==false){f=e(l.selector).addClass(l.skin)}else{var c=l.content||e(this).data("tooltip");f=e('<span class="'+"tooltip "+l.skin+'">'+t+c+"</span>");if(n){f.addClass("ie"+n)}e("body").append(f)}if(r===null){r=e(f)}else{r.add(f)}var h={right:"Left",left:"Right",bottom:"Top",top:"Bottom",topright:"BottomRight",bottomright:"TopRight"};if(l.hasStem){f.addClass("tooltipStem"+h[l.anchor])}f.css(l.css);a={target:e(this),tooltip:f,trigger:l.trigger,delay:l.delay,anchor:l.anchor,offset:l.offset,hasStem:l.hasStem};e(this).data("tooltip-config",a);if(l.trigger==="hover"){e(this).on("mouseenter",i);e(this).on("mouseleave",s)}}})},toggle:function(){return this.each(function(){var t=e(this).data("tooltip-config");if(t&&t.tooltip&&t.tooltip.text()){if(t.tooltip.is(":visible")){a(t)}else{o(t)}}})},enable:function(){return this.each(function(){var t=e(this).data("tooltip-config");if(t&&t.tooltip&&t.tooltip.text()){t.disabled=false;e(this).data("tooltip-config",t)}})},disable:function(){return this.each(function(){var t=e(this).data("tooltip-config");if(t&&t.tooltip&&t.tooltip.text()){t.disabled=true;e(this).data("tooltip-config",t)}})},show:function(){return this.each(function(){var t=e(this).data("tooltip-config");if(t&&t.tooltip&&t.tooltip.text()){o(t)}})},hide:function(){return this.each(function(){var t=e(this).data("tooltip-config");if(t&&t.tooltip){a(t)}})},content:function(t){return this.each(function(){var n=e(this).data("tooltip-config");if(n.tooltip){n.tooltip.html(t)}})}};e.fn.tooltip=function(t){if(f[t]){return f[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return f.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.tooltips")}}})(jQuery)
